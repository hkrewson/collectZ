# v2.0.0-beta.3

## Version and date
- Version: `2.0.0-beta.3`
- Date: `2026-02-25`

## Milestone target and status
- Target milestone: `2.0.0-beta.3`
- Status: Complete
- Focus: mixed-media enrichment integrations for Books, Audio, and Games with admin-managed provider settings.

## Summary
This milestone adds enrichment provider support and lookup/apply flows for Books, Audio, and Games in the unified library UX. It also aligns provider auth behavior with real-world APIs (IGDB/Twitch client credentials, Discogs token), and hardens payload normalization to avoid save-time validation failures.

## What changed
- Added Books, Audio, and Games provider services:
  - `backend/services/books.js`
  - `backend/services/audio.js`
  - `backend/services/games.js`
- Added integration schema/config support for Books/Audio/Games in admin-managed app integrations.
- Added media enrichment endpoints:
  - `POST /api/media/enrich/book/search`
  - `POST /api/media/enrich/audio/search`
  - `POST /api/media/enrich/game/search`
- Expanded Admin Integrations UI with tabs/settings/test actions for:
  - Books (Google Books)
  - Audio (Discogs)
  - Games (IGDB)
- Implemented IGDB auth via Twitch client credentials (`client_id` + `client_secret`) and encrypted secret storage.
- Added migration updates:
  - `v21`: books/audio/games integration columns
  - `v22`: encrypted games client secret
- Added Books author-aware lookup (`intitle` + `inauthor`) for better specificity.
- Improved Discogs lookup query shaping (`release_title`, optional artist, combined query fallback).
- Fixed enrichment mapping normalization to reduce validation failures:
  - absolute URLs for Discogs links
  - normalized year/release dates for books/audio payloads
  - legacy audio config compatibility shim from `theaudiodb` to `discogs` behavior.
- Version metadata aligned to `2.0.0-beta.3` across app metadata and package versions.

## Breaking changes
- No breaking API contract changes for existing 2.0 alpha/beta clients.
- Audio provider defaults are now Discogs-oriented. Existing stale audio configs are compatibility-mapped server-side.

## Environment/config changes
- For Discogs audio enrichment, configure Audio integration token in Admin Integrations.
- For IGDB enrichment, configure:
  - `games_client_id`
  - `games_client_secret` (stored encrypted)
- Existing env values still load as fallback when integration settings are not saved in DB.

## Migration and data impact
- New migrations applied:
  - `v21` Add books/audio/games integration settings columns to `app_integrations`.
  - `v22` Add `games_client_secret_encrypted` to `app_integrations`.
- No destructive migration; additive schema only.
- Existing integration rows remain valid and are read with compatibility logic.

## Deployment and verification
- Build/redeploy:
  - `docker compose --env-file .env up -d --build`
- Verify backend migration logs include `v21` and `v22` success.
- Verify integrations:
  - Admin Settings -> Integrations -> test Books/Audio/Games.
- Verify library flows:
  - Book lookup with title + author, apply, save.
  - Audio lookup with title + artist, apply, save.
  - Game lookup, apply, save.

## Rollback guidance
- Roll back to previous image tag and redeploy.
- Migrations are additive and safe to keep if rolling app code backward in this beta track.
- If rollback to a version before these fields is required for extended time, disable new Books/Audio/Games settings usage in admin UI until forward redeploy.

## Known issues and follow-up
- Discogs metadata quality varies by release entry; duplicate/variant handling remains a follow-up UX/data task.
- Audio track count is not reliably available from Discogs search results; deeper release fetch is a future enhancement.
- Books and audio result ranking can still produce near matches in generic searches; confidence scoring and picker UX improvements remain roadmap follow-ups.
