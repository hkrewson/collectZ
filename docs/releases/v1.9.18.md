# v1.9.18

## Version and date
- Version: `1.9.18`
- Date: `2026-02-24`

## Milestone target and status
- Target: 1.9.18 runtime dependency rationalization (Redis decision)
- Status: Completed

## Summary
Finalized runtime topology as Postgres-only (no Redis), removed unused Redis dependencies/configuration, and added CI enforcement to prevent undeclared runtime dependency drift.

## What changed
### Backend
- Removed unused Redis-related dependencies from backend manifest:
  - `connect-redis`
  - `redis`

### Frontend
- No functional frontend behavior changes in this milestone.

### Database
- No schema changes in this milestone.

### Docs/Ops
- Removed Redis service/runtime references from compose files, environment docs, and deploy docs.
- Updated smoke/deploy expectations to only require `db`, `backend`, and `frontend` health.

### CI
- Added runtime dependency policy gate in `/.github/workflows/docker-publish.yml`:
  - fails if compose files include a `redis` service,
  - fails if `REDIS_URL`/`REDIS_PASSWORD` appear in compose or `env.example`,
  - fails if backend package manifest includes `redis` or `connect-redis`.

## Breaking changes
- Redis is no longer part of the supported runtime stack.
- Existing `.env` files that still contain `REDIS_PASSWORD` remain harmless but unused.

## Environment/config changes
- Removed requirement for `REDIS_PASSWORD`.
- Removed `REDIS_URL` wiring from backend compose environment.

## Migration and data impact
- No migration required.
- Existing Redis containers/volumes become unused and can be removed during cleanup:
  - `docker compose --env-file .env down --remove-orphans`

## Deployment and verification
1. Update repository and env file (drop Redis vars if present).
2. Rebuild and restart:
   - `docker compose --env-file .env up -d --build`
3. Verify service health:
   - `docker compose --env-file .env ps`
4. Verify backend health version:
   - `curl -s http://localhost:3000/api/health`
5. Confirm core flows (login, library load, import queue, admin pages) still work.

## Rollback guidance
- Roll back to prior image tag/commit if needed.
- If rollback expects Redis in compose/env, restore previous compose and `.env` values, then redeploy.

## Known issues and follow-up
- Legacy local `.env` files may still contain Redis keys from older versions; safe but unused.
- Standard dependency vulnerability reduction remains tracked separately in the security hardening milestones.
