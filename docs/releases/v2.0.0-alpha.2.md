# v2.0.0-alpha.2

- Date: 2026-02-24
- Version: `2.0.0-alpha.2`
- Scope: 2.0 Wave 1 multi-library foundation

## Added

- Library management API:
  - `GET /api/libraries`
  - `POST /api/libraries`
  - `PATCH /api/libraries/:id`
  - `DELETE /api/libraries/:id` (blocked if non-empty)
  - `POST /api/libraries/select`
- Active library state persistence in user profile (`active_library_id`) with audit events:
  - `library.create`
  - `library.update`
  - `library.delete`
  - `library.select`
- Sidebar library context controls:
  - Active library selector
  - Create, rename, delete actions

## Changed

- Added migration v16 to backfill library defaults for existing users and assign legacy media without a `library_id`.
- Login/register now ensure each user has a default library context.
- Session user scope resolution now falls back to first accessible library when active library is missing.
- `/api/auth/me` and `/api/profile` now return `active_library_id` and `active_space_id`.

## Validation Notes

- Backend script tests could not run in this sandbox because `node_modules` are not installed locally.
- Syntax checks passed for changed backend files.

## UI Verification Checklist

1. Create a second library from the sidebar and confirm it becomes active.
2. Switch between libraries and confirm items are isolated by library.
3. Add media in library B and confirm it does not appear in library A.
4. Run an import in library B and confirm library A is unchanged.
5. Attempt to delete a non-empty library and confirm it is blocked with a clear error.
6. Delete an empty library and confirm success plus activity log entry.
